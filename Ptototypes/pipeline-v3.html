<!DOCTYPE html>
<html lang="sv">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Redaktionen - AI Pipeline</title>
  <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
  <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
    @keyframes slideDown {
      from {
        max-height: 0;
        opacity: 0;
      }
      to {
        max-height: 500px;
        opacity: 1;
      }
    }

    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(10px); }
      to { opacity: 1; transform: translateY(0); }
    }

    .expand-content {
      animation: slideDown 0.3s ease-out forwards;
    }

    .fade-in {
      animation: fadeIn 0.4s ease-out forwards;
    }
  </style>
</head>
<body class="bg-gray-50">
  <div id="root"></div>

  <script type="text/babel">
    const { useState, useEffect } = React;

    const THEMES = {
      politik: { color: '#3B82F6', label: 'Politik' },
      ekonomi: { color: '#10B981', label: 'Ekonomi' },
      social: { color: '#A855F7', label: 'Social' },
      teknik: { color: '#F97316', label: 'Teknik' },
      miljo: { color: '#14B8A6', label: 'Miljö' },
      juridik: { color: '#EF4444', label: 'Juridik' },
    };

    const AGENTS = {
      tipster: {
        name: 'Greger Palki',
        title: 'Politik tipsare',
        theme: 'POLITIK',
        description: 'Greger bevakar svensk och europeisk politik med fokus på beslut som påverkar vardagen. Han skapar propositioner, utskottsmöten och presskonferenser, samt följer opinismätningar och partistrategier.',
        channels: [
          { name: 'Kulturdepartamentet', type: 'RSS' },
          { name: 'Europaparlamentet', type: 'RSS' },
          { name: 'Europaparlamentet', type: 'RSS' },
          { name: 'Regeringen', type: 'EMAIL' },
          { name: 'Regeringen', type: 'EMAIL' },
        ],
      },
      correspondent: {
        name: 'Alexandra Ström',
        title: 'Politik korrespondent',
        theme: 'POLITIK',
        description: 'Alexandra har över 15 års erfarenhet inom politisk journalistik och specialiserar sig på EU-politik och internationella relationer. Hon har en magisterexamen i statsvetenskap från Stockholms universitet.',
        prompt: 'Alexandra använder modellen GPT-5-mini och är instruerad med följande systemdirektiv:',
        promptText: 'Lorem ipsum dolor sit amet, consectetur adipiscing elit. Praesent vel rutrum mi. Sed libero tellus, molestie non nisl at, tempus vitae nisl.',
      },
      editor: {
        name: 'Ruben Razz',
        title: 'PESTEL-redaktör',
        theme: 'GENERAL',
        description: 'Ruben sammanställer nyhetsrapporterna, granskar relevanta källor, sorterar och syntetiserar information. Han rekontullar att innehållet är exakt, korrekt och välformaterat.',
        prompt: 'Ruben använder modellen GPT-5 och är instruerad med följande systemdirektiv:',
        promptText: 'Lorem ipsum dolor sit amet, consectetur adipiscing elit. Praesent vel rutrum mi. Sed libero tellus, molestie non nisl at, tempus vitae nisl.',
      },
    };

    const STATS = {
      sources: 12,
      signals: 247,
      summaries: 156,
      reports: 6,
    };

    // Minimalist Icons
    const RssIcon = () => (
      <svg className="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
        <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={1.5} d="M6 5c7.18 0 13 5.82 13 13M6 11a7 7 0 017 7m-6 0a1 1 0 11-2 0 1 1 0 012 0z" />
      </svg>
    );

    const FunnelIcon = () => (
      <svg className="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
        <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={1.5} d="M3 4a1 1 0 011-1h16a1 1 0 011 1v2.586a1 1 0 01-.293.707l-6.414 6.414a1 1 0 00-.293.707V17l-4 4v-6.586a1 1 0 00-.293-.707L3.293 7.293A1 1 0 013 6.586V4z" />
      </svg>
    );

    const DocumentIcon = () => (
      <svg className="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
        <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={1.5} d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z" />
      </svg>
    );

    const NewspaperIcon = () => (
      <svg className="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
        <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={1.5} d="M19 20H5a2 2 0 01-2-2V6a2 2 0 012-2h10a2 2 0 012 2v1m2 13a2 2 0 01-2-2V7m2 13a2 2 0 002-2V9a2 2 0 00-2-2h-2m-4-3H9M7 16h6M7 8h6v4H7V8z" />
      </svg>
    );

    const EmailIcon = () => (
      <svg className="w-4 h-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
        <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={1.5} d="M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z" />
      </svg>
    );

    const ChevronDownIcon = () => (
      <svg className="w-4 h-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
        <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M19 9l-7 7-7-7" />
      </svg>
    );

    const ChevronUpIcon = () => (
      <svg className="w-4 h-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
        <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M5 15l7-7 7 7" />
      </svg>
    );

    // Avatar Icon for agents
    const UserIcon = ({ initials, color = "#6B7280" }) => (
      <div className="w-8 h-8 rounded-full flex items-center justify-center text-white text-xs font-semibold" style={{ backgroundColor: color }}>
        {initials}
      </div>
    );

    // Minimalist Arrow
    const Arrow = ({ delay = 0 }) => {
      const [visible, setVisible] = useState(false);

      useEffect(() => {
        const timer = setTimeout(() => setVisible(true), delay * 1000);
        return () => clearTimeout(timer);
      }, [delay]);

      if (!visible) return <div className="h-8"></div>;

      return (
        <div className="flex justify-center items-center h-8">
          <svg width="24" height="32" className="text-gray-300">
            <line x1="12" y1="0" x2="12" y2="24" stroke="currentColor" strokeWidth="1.5" />
            <polygon points="12,32 8,26 16,26" fill="currentColor" />
          </svg>
        </div>
      );
    };

    // Compact Node Card
    const NodeCard = ({ title, subtitle, icon: Icon, count, themes, agent, agentKey, delay = 0 }) => {
      const [visible, setVisible] = useState(false);
      const [expanded, setExpanded] = useState(false);

      useEffect(() => {
        const timer = setTimeout(() => setVisible(true), delay * 1000);
        return () => clearTimeout(timer);
      }, [delay]);

      const hasAgent = agent !== undefined;
      const agentData = hasAgent ? AGENTS[agentKey] : null;

      return (
        <div 
          className={`w-full max-w-sm mx-auto transition-all duration-500 ${visible ? 'opacity-100 translate-y-0 fade-in' : 'opacity-0 translate-y-4'}`}
        >
          {/* Main Node */}
          <div className={`border border-gray-200 rounded-lg bg-white shadow-sm ${expanded ? 'shadow-md' : ''}`}>
            {/* Header */}
            <div className="p-3 flex items-center gap-2.5">
              {/* Icon/Avatar */}
              <div className="flex-shrink-0">
                {hasAgent ? (
                  <UserIcon 
                    initials={agentData.name.split(' ').map(n => n[0]).join('')} 
                    color="#6B7280"
                  />
                ) : (
                  <div className="w-8 h-8 rounded-lg bg-gray-100 flex items-center justify-center text-gray-600">
                    <Icon />
                  </div>
                )}
              </div>

              {/* Content */}
              <div className="flex-1 min-w-0">
                <h3 className="text-sm font-semibold text-gray-900 truncate">{title}</h3>
                <p className="text-xs text-gray-500 truncate">{subtitle}</p>
              </div>

              {/* Right Side */}
              <div className="flex items-center gap-2">
                {/* Themes */}
                {themes && !expanded && (
                  <div className="flex gap-1">
                    {Object.entries(THEMES).map(([key, theme]) => (
                      <div 
                        key={key} 
                        className="w-1.5 h-1.5 rounded-full" 
                        style={{ backgroundColor: theme.color }}
                        title={theme.label}
                      />
                    ))}
                  </div>
                )}

                {/* Count */}
                {count !== undefined && (
                  <div className="text-right">
                    <div className="text-lg font-bold text-gray-700">{count}</div>
                  </div>
                )}

                {/* Expand button */}
                {hasAgent && (
                  <button
                    onClick={() => setExpanded(!expanded)}
                    className="p-1 hover:bg-gray-100 rounded transition-colors text-gray-400 hover:text-gray-600"
                  >
                    {expanded ? <ChevronUpIcon /> : <ChevronDownIcon />}
                  </button>
                )}
              </div>
            </div>

            {/* Expanded Content */}
            {hasAgent && expanded && (
              <div className="border-t border-gray-100 p-3 space-y-3 expand-content">
                {/* Agent Info */}
                <div>
                  <div className="flex items-center gap-2 mb-2">
                    <UserIcon 
                      initials={agentData.name.split(' ').map(n => n[0]).join('')} 
                      color="#6B7280"
                    />
                    <div>
                      <p className="text-sm font-semibold text-gray-900">{agentData.name}</p>
                      <p className="text-xs text-gray-500">{agentData.title}</p>
                    </div>
                  </div>
                  <p className="text-xs text-gray-600 leading-relaxed">{agentData.description}</p>
                </div>

                {/* Themes */}
                {themes && (
                  <div className="flex flex-wrap gap-1.5">
                    {Object.entries(THEMES).map(([key, theme]) => (
                      <div key={key} className="flex items-center gap-1 px-2 py-1 bg-gray-50 rounded text-xs text-gray-700">
                        <div className="w-1.5 h-1.5 rounded-full" style={{ backgroundColor: theme.color }} />
                        {theme.label}
                      </div>
                    ))}
                  </div>
                )}

                {/* Channels */}
                {agentData.channels && (
                  <div>
                    <p className="text-xs font-semibold text-gray-700 mb-1.5">Kanaler</p>
                    <div className="space-y-1">
                      {agentData.channels.map((channel, idx) => (
                        <div key={idx} className="flex items-center gap-2 text-xs text-gray-600 bg-gray-50 px-2 py-1 rounded">
                          {channel.type === 'RSS' ? <RssIcon /> : <EmailIcon />}
                          <span className="flex-1 truncate">{channel.name}</span>
                          <span className="text-gray-400">{channel.type}</span>
                        </div>
                      ))}
                    </div>
                  </div>
                )}

                {/* Prompt */}
                {agentData.prompt && (
                  <div>
                    <p className="text-xs font-semibold text-gray-700 mb-1">{agentData.prompt}</p>
                    <div className="bg-gray-50 rounded px-2 py-1.5">
                      <p className="text-xs text-gray-600 italic">{agentData.promptText}</p>
                    </div>
                  </div>
                )}
              </div>
            )}
          </div>
        </div>
      );
    };

    // Main App
    const App = () => {
      return (
        <div className="min-h-screen bg-gray-50 py-12 px-4">
          <div className="max-w-4xl mx-auto">
            {/* Header */}
            <div className="text-center mb-12">
              <h1 className="text-3xl font-bold text-gray-900 mb-2">
                AI-Driven News Pipeline
              </h1>
              <p className="text-base text-gray-600">
                Från rådata till färdiga rapporter genom intelligent automatisering
              </p>
            </div>

            {/* Pipeline */}
            <div className="space-y-0">
              <NodeCard
                title="Sources"
                subtitle="RSS feeds & Email newsletters"
                icon={RssIcon}
                count={STATS.sources}
                delay={0.1}
              />
              
              <Arrow delay={0.15} />

              <NodeCard
                title="Tipsare (Tipster)"
                subtitle="AI-agent filtrerar och kategoriserar"
                icon={FunnelIcon}
                themes
                agent
                agentKey="tipster"
                delay={0.2}
              />

              <Arrow delay={0.25} />

              <NodeCard
                title="Signals"
                subtitle="Råa nyhetskort från källor"
                icon={DocumentIcon}
                count={STATS.signals}
                delay={0.3}
              />

              <Arrow delay={0.35} />

              <NodeCard
                title="Korrespondent (Correspondent)"
                subtitle="AI-agent analyserar och sammanfattar"
                icon={DocumentIcon}
                themes
                agent
                agentKey="correspondent"
                delay={0.4}
              />

              <Arrow delay={0.45} />

              <NodeCard
                title="Summaries"
                subtitle="Kortfattade sammanfattningar"
                icon={DocumentIcon}
                count={STATS.summaries}
                delay={0.5}
              />

              <Arrow delay={0.55} />

              <NodeCard
                title="Redaktör (Editor)"
                subtitle="AI-agent syntetiserar och redigerar"
                icon={DocumentIcon}
                agent
                agentKey="editor"
                delay={0.6}
              />

              <Arrow delay={0.65} />

              <NodeCard
                title="Reports"
                subtitle="Färdiga analytiska artiklar"
                icon={NewspaperIcon}
                count={STATS.reports}
                delay={0.7}
              />
            </div>

            {/* Info Box */}
            <div className="mt-10 text-center">
              <p className="text-sm text-gray-500">
                Klicka på ˅ för att se detaljer om AI-agenter
              </p>
            </div>
          </div>
        </div>
      );
    };

    const root = ReactDOM.createRoot(document.getElementById('root'));
    root.render(<App />);
  </script>
</body>
</html>
